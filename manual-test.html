<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Distance Test - Geneva 68361</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        .facility { padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px; }
        .within-radius { background-color: #e8f5e8; }
        .outside-radius { background-color: #ffeaea; }
        .coords { font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Manual Distance Test for Geneva, NE 68361</h1>
        <p><strong>Geneva Coordinates:</strong> 40.53°N, -97.60°W</p>
        <p><strong>Search Radius:</strong> 75 miles</p>
        
        <div id="results"></div>
    </div>

    <script>
        // Geneva, NE coordinates
        const genevaLat = 40.53;
        const genevaLng = -97.60;
        const searchRadius = 75;

        // Sample facilities with known coordinates
        const facilitiesWithCoords = [
            {
                name: "Omaha Facility",
                address: "2900 Blondo Street, Omaha, NE 68111",
                lat: 41.3033,
                lng: -95.9922
            },
            {
                name: "Lincoln Facility", 
                address: "2200 South 10th Street, Lincoln, NE 68502",
                lat: 40.7914,
                lng: -96.6665
            },
            {
                name: "Grand Island Facility",
                address: "914 Baumann Avenue, Grand Island, NE 68803",
                lat: 40.9249,
                lng: -98.3420
            },
            {
                name: "Mid Plains Center - Kearney",
                address: "Kearney, NE",
                lat: 40.78699,
                lng: -99.75884
            },
            {
                name: "Mid Plains Center - Lexington",
                address: "Lexington, NE", 
                lat: 40.79129,
                lng: -99.51097
            },
            {
                name: "Mid Plains Center - Holdrege",
                address: "Holdrege, NE",
                lat: 40.77799,
                lng: -99.73803
            },
            {
                name: "North Platte Facility",
                address: "North Platte, NE",
                lat: 41.14007,
                lng: -100.7603
            },
            {
                name: "Hastings Facility",
                address: "Hastings, NE",
                lat: 40.6897,
                lng: -99.0774
            },
            {
                name: "York Facility",
                address: "York, NE",
                lat: 40.9576,
                lng: -98.394
            }
        ];

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 3959; // Earth's radius in miles
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c; // Distance in miles
        }

        // Calculate distances and categorize
        const facilitiesWithDistance = facilitiesWithCoords.map(facility => {
            const distance = calculateDistance(genevaLat, genevaLng, facility.lat, facility.lng);
            return {
                ...facility,
                distance: distance,
                withinRadius: distance <= searchRadius
            };
        });

        // Sort by distance
        facilitiesWithDistance.sort((a, b) => a.distance - b.distance);

        // Display results
        const resultsDiv = document.getElementById('results');
        
        const withinRadius = facilitiesWithDistance.filter(f => f.withinRadius);
        const outsideRadius = facilitiesWithDistance.filter(f => !f.withinRadius);
        
        resultsDiv.innerHTML = `
            <h2>Facilities Within 75 Miles (${withinRadius.length} found)</h2>
            ${withinRadius.map(f => `
                <div class="facility within-radius">
                    <strong>${f.name}</strong><br>
                    ${f.address}<br>
                    <span style="color: green; font-weight: bold;">Distance: ${f.distance.toFixed(1)} miles</span><br>
                    <span class="coords">Coordinates: ${f.lat}, ${f.lng}</span>
                </div>
            `).join('')}
            
            <h2>Facilities Outside 75 Miles (${outsideRadius.length})</h2>
            ${outsideRadius.map(f => `
                <div class="facility outside-radius">
                    <strong>${f.name}</strong><br>
                    ${f.address}<br>
                    <span style="color: red; font-weight: bold;">Distance: ${f.distance.toFixed(1)} miles</span><br>
                    <span class="coords">Coordinates: ${f.lat}, ${f.lng}</span>
                </div>
            `).join('')}
        `;
    </script>
</body>
</html>